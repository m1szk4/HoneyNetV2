##############################################################################
# AIDE Configuration File for HoneyNetV2
# Advanced Intrusion Detection Environment
#
# This configuration monitors critical system files and HoneyNetV2 components
# for unauthorized changes, helping detect potential security breaches.
#
# Installation: Copy this file to /etc/aide/aide.conf
##############################################################################

# Database and configuration paths
@@define DBDIR /var/lib/aide
@@define LOGDIR /var/log/aide

# Database locations
database=file:@@{DBDIR}/aide.db
database_out=file:@@{DBDIR}/aide.db.new
database_new=file:@@{DBDIR}/aide.db.new

# Report settings
report_url=file:@@{LOGDIR}/aide.log
report_url=stdout

# Verbose level (0-255)
verbose=5

# Custom rule definitions
# p: permissions
# i: inode
# n: number of links
# u: user
# g: group
# s: size
# b: block count
# m: mtime
# a: atime
# c: ctime
# S: check for growing size
# md5: MD5 checksum
# sha256: SHA256 checksum
# sha512: SHA512 checksum

# Define custom rules
NORMAL = p+i+n+u+g+s+b+m+c+md5+sha256+sha512
DIR = p+i+n+u+g
DATAONLY = p+n+u+g+s+b+m+c+md5+sha256+sha512
LSPP = p+i+n+u+g+s+b+m+c+md5+sha256+sha512
LOG = p+u+g+n+S
FREQUENT = sha256
GROWING = p+u+g+i+n+S

##############################################################################
# SYSTEM CRITICAL FILES - Host System Monitoring
##############################################################################

# System binaries - critical executables
/bin NORMAL
/sbin NORMAL
/usr/bin NORMAL
/usr/sbin NORMAL
/usr/local/bin NORMAL
/usr/local/sbin NORMAL

# System libraries
/lib NORMAL
/lib64 NORMAL
/usr/lib NORMAL
/usr/lib64 NORMAL

# Boot files (critical for system integrity)
/boot NORMAL

# System configuration files
/etc NORMAL
!/etc/mtab
!/etc/adjtime
!/etc/resolv.conf
!/etc/issue
!/etc/issue.net
!/etc/motd
!/etc/group-
!/etc/passwd-
!/etc/shadow-
!/etc/gshadow-
!/etc/cups/subscriptions.conf
!/etc/cups/subscriptions.conf.O

# Network configuration (monitor changes to network setup)
/etc/network NORMAL
/etc/netplan NORMAL
/etc/hosts NORMAL
/etc/hostname NORMAL

# SSH configuration (critical for remote access security)
/etc/ssh/sshd_config NORMAL
/etc/ssh/ssh_config NORMAL
/root/.ssh NORMAL

# Systemd services (monitor for malicious service installation)
/etc/systemd/system NORMAL
/usr/lib/systemd/system NORMAL

# Cron jobs (monitor for backdoor cron entries)
/etc/cron.d NORMAL
/etc/cron.daily NORMAL
/etc/cron.hourly NORMAL
/etc/cron.monthly NORMAL
/etc/cron.weekly NORMAL
/etc/crontab NORMAL
/var/spool/cron NORMAL

# PAM configuration (authentication)
/etc/pam.d NORMAL

# Sudoers configuration
/etc/sudoers NORMAL
/etc/sudoers.d NORMAL

##############################################################################
# HONEYNETV2 APPLICATION FILES
##############################################################################

# Project root directory (adjust path as needed)
# Note: Update HONEYNET_PATH to your actual installation directory
@@define HONEYNET_PATH /opt/HoneyNetV2

# Honeypot implementations
@@{HONEYNET_PATH}/honeypots NORMAL
!/@@{HONEYNET_PATH}/honeypots/__pycache__
!/@@{HONEYNET_PATH}/honeypots/**/__pycache__
!/@@{HONEYNET_PATH}/honeypots/**/*.pyc

# RTSP Honeypot
@@{HONEYNET_PATH}/honeypots/rtsp/rtsp_honeypot.py NORMAL

# UPnP Honeypot
@@{HONEYNET_PATH}/honeypots/upnp/upnp_honeypot.py NORMAL

# Monitoring scripts
@@{HONEYNET_PATH}/scripts/monitoring NORMAL

# Maintenance scripts
@@{HONEYNET_PATH}/scripts/maintenance NORMAL

# Deployment scripts
@@{HONEYNET_PATH}/scripts/deployment NORMAL

# PCAP capture scripts
@@{HONEYNET_PATH}/scripts/pcap NORMAL

# ETL scripts
@@{HONEYNET_PATH}/scripts/etl NORMAL

# Configuration files
@@{HONEYNET_PATH}/configs NORMAL

# Docker configuration
@@{HONEYNET_PATH}/docker-compose.yml NORMAL
@@{HONEYNET_PATH}/Dockerfile NORMAL

# Environment configuration (if exists)
@@{HONEYNET_PATH}/.env NORMAL

# Documentation (monitor for unauthorized changes)
@@{HONEYNET_PATH}/README.md NORMAL
@@{HONEYNET_PATH}/RTSP_IMPLEMENTATION.md NORMAL
@@{HONEYNET_PATH}/UPNP_IMPLEMENTATION.md NORMAL

# Ansible playbooks
@@{HONEYNET_PATH}/ansible NORMAL

# Test files (monitor for tampering)
@@{HONEYNET_PATH}/tests NORMAL
!/@@{HONEYNET_PATH}/tests/__pycache__
!/@@{HONEYNET_PATH}/tests/**/__pycache__
!/@@{HONEYNET_PATH}/tests/**/*.pyc

##############################################################################
# DOCKER MONITORING
##############################################################################

# Docker daemon configuration
/etc/docker NORMAL

# Docker systemd service
/etc/systemd/system/docker.service.d NORMAL

##############################################################################
# LOG FILES - Monitor for tampering but allow growth
##############################################################################

# System logs (allow growth but monitor permissions)
/var/log LOG

# AIDE logs
@@{LOGDIR} LOG

##############################################################################
# AIDE DATABASE PROTECTION
##############################################################################

# Monitor AIDE's own files
@@{DBDIR}/aide.db NORMAL
@@{DBDIR}/aide.db.new NORMAL
/etc/aide NORMAL

##############################################################################
# EXCLUSIONS - Files that change frequently and don't need monitoring
##############################################################################

# Temporary directories
!/tmp
!/var/tmp
!/var/cache
!/var/spool

# Process information
!/proc
!/sys
!/dev

# Package manager caches
!/var/lib/apt
!/var/lib/dpkg

# Docker runtime data
!/var/lib/docker

# Container runtime
!/run
!/var/run

# Mail spool
!/var/mail
!/var/spool/mail

# Log files rotation
!/var/log/.*\.gz$
!/var/log/.*\.[0-9]$

# Systemd journals
!/var/log/journal

##############################################################################
# END OF CONFIGURATION
##############################################################################
